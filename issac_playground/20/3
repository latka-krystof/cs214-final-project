


MAIN_MODEL="meta-llama/Llama-3.2-3B-Instruct"
DRAFT_MODEL="meta-llama/Llama-3.2-1B-Instruct"

echo ">>> Starting Instance A: Main Model on Port 8001..."
CUDA_VISIBLE_DEVICES=0 python -m vllm.entrypoints.openai.api_server \
    --model $MAIN_MODEL \
    --gpu-memory-utilization 0.85 \
    --max-model-len 2048 \
    --port 8001 \
    --enforce-eager \
    --attention-backend TRITON_ATTN \
    --uvicorn-log-level error &


echo ">>> Starting Instance C: SPECULATIVE (Fast but fragile) on Port 8003..."
CUDA_VISIBLE_DEVICES=0 python -m vllm.entrypoints.openai.api_server \
    --model $MAIN_MODEL \
    --max-model-len 2048 \
    --speculative-config "{\"model\": \"$DRAFT_MODEL\", \"num_speculative_tokens\": 5, \"method\": \"draft_model\"}" \
    --gpu-memory-utilization 0.85 \
    --port 8003 \
    --enforce-eager \
    --attention-backend TRITON_ATTN \
    --uvicorn-log-level error &




Non spec

float8
═══════════════════════════════════════════════════════
  vLLM Router Benchmark Report
═══════════════════════════════════════════════════════
  Total requests      : 20
  Successful          : 20
  Failed              : 0
  Wall-clock time     : 290.60s
  Throughput          : 0.07 req/s
  Total tokens out    : 14362
  Token throughput    : 49.4 tok/s

  Latency (seconds):
    min   : 9.220s
    p50   : 32.382s
    p95   : 41.279s
    p99   : 41.279s
    max   : 41.279s
    mean  : 28.921s
    stdev : 12.705s
═══════════════════════════════════════════════════════

═══════════════════════════════════════════════════════
  vLLM Router Benchmark Report
═══════════════════════════════════════════════════════
  Total requests      : 20
  Successful          : 20
  Failed              : 0
  Wall-clock time     : 424.69s
  Throughput          : 0.05 req/s
  Total tokens out    : 14805
  Token throughput    : 34.9 tok/s

  Latency (seconds):
    min   : 10.426s
    p50   : 45.047s
    p95   : 61.084s
    p99   : 61.084s
    max   : 61.084s
    mean  : 41.389s
    stdev : 17.418s
═══════════════════════════════════════════════════════

